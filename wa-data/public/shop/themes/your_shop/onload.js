$(document).on("submit",".product-list form.addtocart",function(){var t=function(t){$(".cart-total, .fly-cart .total").html(t.total),$("#cart").find(".indicator").text(t.count),$(".fly-discount .discount").html(t.discount)},a=$(this);a.attr("data-id","");var e=a.find(".addtocart-form input[type='submit']");if(!e.hasClass("active")){if(e.addClass("active"),a.data("url")){var i=$("#dialog"),s=i.find(".content");return s.load(a.data("url")+(void 0!==a.attr("data-sku")?"&sku_id="+a.attr("data-sku"):""),function(){e.removeClass("active"),s.find(".dialog-close").length||s.prepend('<a href="#" class="dialog-close">x</a>'),i.show(function(){$("body").addClass("dialog-open")})}),!1}$.post(a.attr("action")+"?html="+("html"==$.yourshop.ruble?"1":"0"),a.serialize(),function(i){if(e.removeClass("active"),"ok"==i.status){var s=$("#cart"),o=$(".cart-total, .fly-cart .total");if($(".cart-page").length&&$.get(location.href,function(t){$(".cart-page").html($(t).html()),o.html(i.data.total)},"html"),i.data.error)alert(i.data.error);else{s.find(".indicator").text(i.data.count).show();var r=e.val();e.val($.yourshop.translate("Added")),setTimeout(function(){e.val(r)},2500);var n=parseInt($(".add2cart input[name='quantity']").val())||1,l=$(".fly-cart"),d=l.find(".fly-item[data-id='"+i.data.item_id+"']");if(a.closest("#dialog").length)var c=$(".product-list .product-item[data-id='"+a.find("input[name*='product_id']")+"']");else var c=a.closest(".product-item");if(d.length){var u=d.find(".qty"),p=d.find(".fly-price"),h=parseFloat(p.text().replace(",",".").replace(/[^\d\.]/g,""))+parseFloat(c.find(".price").text().replace(",",".").replace(/[^\d\.]/g,""))*n;n+=parseInt(u.val()),u.val(n),p.html("~"+h.toFixed(2).replace(".",",")+" "+$.yourshop.currency)}else{var f=c.find("h5 a").clone();f.find(".table").remove();var m='<div class="fly-item" data-id="'+i.data.item_id+'"><div class="fly-img"><a href="'+c.find(".image a").attr("href")+'" title="'+f.find("span").html()+'">'+c.find(".image").data("small")+'</a></div><div class="fly-info"><div class="fly-name">'+f.prop("outerHTML")+'</div><div class="fly-quantity"><a href="javascript:void(0)" title="'+$.yourshop.translate("decrease")+'" class="f-minus"><i class="ys ys-larr"></i></a><input type="text" value="'+n+'" class="qty" /><a href="javascript:void(0)" title="'+$.yourshop.translate("increase")+'" class="f-plus"><i class="ys ys-rarr"></i></a></div><div class="fly-price price colored">~'+c.find(".price").html()+'</div></div><div class="fly-icons"><a href="javascript:void(0)" class="delete" title="'+$.yourshop.translate("Delete")+'" data-id="'+i.data.item_id+'">x</a></div></div>';if(!s.hasClass("has-items")){var v=s.find("a");$(".fly-content").find("p").remove(),v.attr("href",v.data("url")).parent().addClass("has-items")}$(".fly-content").append(m)}s.addClass("has-items"),t(i.data),bouncePopup(s,"+ "+$.yourshop.translate("Added to cart"))}}else"fail"==i.status&&alert(i.errors)},"json")}return!1}),$(document).on("click",".quick-view",function(){var t=$(this),a=$("#dialog");if(!a.hasClass("quick-view-dial")){a.show(function(){$("body").addClass("dialog-open")}).find(".content").addClass("align-center").append('<span class="temp-loader"><i class="icon16 loading3" style="vertical-align: middle;"></i> '+$.yourshop.translate("Wait, please. Information is loading")+"</span>"),a.find(".dialog-close").length||a.find(".content").prepend('<a href="#" class="dialog-close">x</a>');var e=t.closest("form");$.get(t.attr("href")+"?quickview=1"+(void 0!==e.attr("data-sku")?"&sku_id="+e.attr("data-sku"):""),function(e){var i=$(e).find(".product-page");i.removeClass("wrap").find(".product-full, .related, .category-sidebar, .goto-review").remove(),i.find(".product-sidebar").removeClass(),i.find(".cart-form").append("<a href='"+t.attr("href")+"' class='button grey' style='display: inline-block;'>"+$.yourshop.translate("Go to product page")+"</a>"),a.addClass("quick-view-dial").find(".temp-loader").remove(),a.find(".content").removeClass("align-center").append(i)},"html")}return!1}),$(document).on("click",".f-quantity-minus",function(){var t=$(this).closest(".quantity").find("input[name*='quantity']");parseInt(t.val())>1&&!$(this).find("i").hasClass("loading")&&t.val(function(t,a){return--a}).trigger("change")}),$(document).on("click",".f-quantity-plus",function(){$(this).find("i").hasClass("loading")||$(this).closest(".quantity").find("input[name*='quantity']").val(function(t,a){return++a}).trigger("change")});var catDesc=$(".category-desc-cut");if(catDesc.length){var cutDescHeight=catDesc.height(),fullDescHeight=catDesc.css("height","auto").height();catDesc.height(cutDescHeight),$(".cat-cut-link").click(function(){var t=$(this);if(catDesc.is(":animated"))return!1;var a=t.text(),e=t.attr("data-toggle");catDesc.hasClass("opened")?catDesc.animate({height:cutDescHeight},500,function(){$(this).removeClass("opened"),t.attr("data-toggle",a).attr("title",e).html(e),t.append("<i class='fa fa-arrow-circle-down'></i>")}):catDesc.animate({height:fullDescHeight},500,function(){$(this).addClass("opened"),t.attr("data-toggle",a).attr("title",e).html(e),t.append("<i class='fa fa-arrow-circle-up'></i>")})})}var removeParam=function(t,a){var e,i=a.split("?")[0],s=[],o=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==o){s=o.split("&");for(var r=s.length-1;r>=0;r-=1)e=s[r].split("=")[0],e===t&&s.splice(r,1);i=i+"?"+s.join("&")}return i};$("#products-per-page a").click(function(){var t=$(this);return t.hasClass("selected")||(t.data("perpage")?$.cookie("products_per_page",t.data("perpage"),{expires:30,path:$.yourshop.shopUrl}):$.cookie("products_per_page","",{expires:0,path:$.yourshop.shopUrl}),location.href=removeParam("page",location.href)),!1}),$("#products-per-page").change(function(){var t=$(this);return t.is(":selected")?!1:(t.val()?$.cookie("products_per_page",t.val(),{expires:30,path:$.yourshop.shopUrl}):$.cookie("products_per_page","",{expires:0,path:$.yourshop.shopUrl}),void(location.href=removeParam("page",location.href)))});var saveProductSku=function(t){var a=t.closest("form");void 0!==a.attr("data-sku")&&$.cookie("yourshop_product_sku",a.attr("data-sku"),{expires:1,path:$.yourshop.shopUrl})};$(document).on({click:function(){saveProductSku($(this))},mouseup:function(t){t.which<=2&&saveProductSku($(this))}},".product-item .product-image, .product-item h5 > a"),$(".cancel-viewed").click(function(){$(this).after("<i class='icon16 loading'></i>"),$.cookie("shop_yourshop_viewed",null,{path:$.yourshop.siteUrl}),location.reload()}),$(".cancel-favourite").click(function(){$(this).after("<i class='icon16 loading'></i>"),$.cookie("shop_yourshop_favourite",null,{path:$.yourshop.siteUrl}),location.reload()}),$(document).on({mouseenter:function(){var t=$(this).find(".sku-thumbs-slider"),a=$("#product-list .product-list");if(t.hasClass("slick-initialized")){var e=5;a.hasClass("table")?e=3:a.hasClass("thumbs-small")&&(e=4),t.slick("slickSetOption","slidesToShow",e,!0)}else{var i=t.data("images"),s="";$.each(i,function(t,a){s+="<div style='width: 50px; height: 50px;'><img src='"+a.img+"' data-id='"+t+"'></div>"}),t.html(s),a.hasClass("has-thumbs-slider")||a.addClass("has-thumbs-slider");var o={autoplay:!1,draggable:!1,infinite:!1,vertical:!0,prevArrow:'<div class="slider-prev"><i class="fa fa-chevron-up"></i></div>',nextArrow:'<div class="slider-next"><i class="fa fa-chevron-down"></i></div>',slidesToShow:5,slidesToScroll:1,appendArrows:t.closest(".slider-custom")};a.hasClass("table")?o.slidesToShow=3:a.hasClass("thumbs-small")&&(o.slidesToShow=4),t.slick(o)}}},".not-mobile .product-item.has-images.type-thumbs"),$(document).on({mouseenter:function(){var t=$(this);if(!t.hasClass("selected")){t.closest(".sku-thumbs").find("img").removeClass("selected"),t.addClass("selected");var a=t.closest(".product-item"),e=a.find(".sku-thumbs-slider").data("images"),i=e[t.data("id")];a.find(".product-image img").attr("src",i.largeImg).removeAttr("width height"),void 0!==i.comparepr&&(a.find(".prices").html(("0"!==i.comparepr?'<span class="compare-price">'+i.comparepr+"</span> ":"")+'<span class="price'+("0"!==i.comparepr?" colored":"")+'" itemprop="price">'+i.price+"</span>"),"undefined"!=typeof i.sku?a.find(".sku").length?a.find(".sku").text($.yourshop.translate("SKU")+": "+i.sku):a.find(".addtocart").prepend("<div class='sku'>"+$.yourshop.translate("SKU")+": "+i.sku+"</div>"):a.find(".sku").remove(),"undefined"!=typeof i.skuName?a.find(".sku-name").length?a.find(".sku-name").text(i.skuName):a.find("h5").after("<div class='sku-name'>"+i.skuName+"</div>"):a.find(".sku-name").remove(),a.find("form.addtocart").attr("data-sku",t.data("id")))}},click:function(){var t=$(this);!t.closest(".sku-thumbs-slider").hasClass("only-images")&&$.cookie("yourshop_product_sku",t.data("id"),{expires:1,path:$.yourshop.shopUrl}),location.href=t.closest(".product-item").find(".product-image").attr("href")}},".not-mobile .sku-thumbs img"),$.yourshop.swipeImageThumbs=function(t,a){var e,i=t.data("images"),s=t.data("images-keys").split(","),o=$.inArray(t.attr("data-sku-id"),s);t.find("img").hide().after("<i class='icon16 loading'></i>"),"next"==a&&o==s.length-1?e=i[s[0]]:"next"==a?e=i[s[o+1]]:"prev"==a&&0==o?e=i[s[s.length-1]]:"prev"==a&&(e=i[s[o-1]]);var r=t.closest(".product-item"),n=void 0!==e.comparepr?r.find("h5, .offers"):t.find("img");n.animate({opacity:0,visibility:"hidden"},500,function(){$("<img src='"+e.largeImg+"'>").load(function(a,i,s){t.find("img").replaceWith($(this)),void 0!==e.comparepr&&(r.find(".prices").html(("0"!==e.comparepr?'<span class="compare-price">'+e.comparepr+"</span> ":"")+'<span class="price'+("0"!==e.comparepr?" colored":"")+'" itemprop="price">'+e.price+"</span>"),r.find("form.addtocart").attr("data-sku",e.id),"undefined"!=typeof e.sku?r.find(".sku").length?r.find(".sku").text($.yourshop.translate("SKU")+": "+e.sku):r.find(".addtocart").prepend("<div class='sku'>"+$.yourshop.translate("SKU")+": "+imgData.sku+"</div>"):r.find(".sku").remove(),"undefined"!=typeof e.skuName?r.find(".sku-name").length?r.find(".sku-name").text(e.skuName):r.find("h5").after("<div class='sku-name'>"+e.skuName+"</div>"):r.find(".sku-name").remove()),t.attr("data-sku-id",e.id+"s"),t.find(".loading").remove(),n.animate({opacity:1,visibility:"visible"},500)})})},$(document).on("click",".image-thumbs-nav",function(){var t=$(this);$.yourshop.swipeImageThumbs(t.closest(".image").find(".product-image"),t.hasClass("s-next")?"next":"prev")}),$.yourshop.initProductSwipeEvent=function(t){t.swipe({swipe:function(t,a){"left"==a?$.yourshop.swipeImageThumbs($(this).find(".product-image"),"next"):"right"==a&&$.yourshop.swipeImageThumbs($(this).find(".product-image"),"prev")},allowPageScroll:"vertical",preventDefaultEvents:!1,threshold:35,excludedElements:[]})},$.yourshop.initProductSwipeEvent($(".product-item .image.swipeable")),$("#yourshop.shop .search-input-field").length&&$.yourshop.searchAutocomplete&&$("#yourshop.shop .search-input-field").each(function(){var t=$(this),a={minChars:"2",maxHeight:"300",deferRequestBy:"350",width:"300",noCache:!1,autoSelectFirst:!1,serviceUrl:$.yourshop.shopUrl+"search/",appendTo:t.closest("form"),formatResult:function(t,a){var e=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i="("+e+")";return"<a href='"+t.url+(t.showAll?"?query="+a:"")+"' "+(t.showAll?"class='show-all'":"")+">"+t.image+(t.showAll?$.yourshop.translate("Show all"):t.value.replace(new RegExp(i,"gi"),"<strong>$1</strong>"))+"</a><div class='autocomplete-price'>"+t.price+"</div>"},transformResult:function(t){var a=[];return $.each($(t).find(".product-list li"),function(t,e){return 5==t?(a[t]={url:$.yourshop.shopUrl+"search/",image:"",value:"",price:"",showAll:!0},!1):(e=$(e),void(a[t]={url:e.find("h5 a").attr("href"),image:e.find(".image").data("small"),value:e.find("h5 a .thumbs").text(),price:e.find(".prices").html(),showAll:!1}))}),{suggestions:a}},beforeRender:function(a){a.css("top",t.outerHeight())},onSearchStart:function(){$(this).addClass("autocomplete-loader")},onSearchComplete:function(){$(this).removeClass("autocomplete-loader")},onSelect:function(t){location.href=t.url}};$(this).autocomplete(a)}),$.fn.countdowntimer&&$(".js-promo-countdown").each(function(){var t=$(this).html(""),a=t.attr("id")||"js-promo-countdown"+(""+Math.random()).slice(2);t.attr("id",a);var e=t.data("start").replace(/-/g,"/"),i=t.data("end").replace(/-/g,"/");t.countdowntimer({startDate:e,dateAndTime:i,size:"md"})});